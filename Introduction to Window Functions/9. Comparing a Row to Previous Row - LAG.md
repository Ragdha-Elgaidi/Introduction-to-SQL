LAG function

Purpose

It returns the value from a previous row to the current row in the table.

Step 1:

Letâ€™s first look at the inner query and see what this creates.

SELECT     account_id, SUM(standard_qty) AS standard_sum
FROM       orders
GROUP BY   1

What you see after running this SQL code:

    The query sums the standard_qty amounts for each account_id to give the standard paper each account has purchased overall time. E.g., account_id 2951 has purchased 8181 units of standard paper.
    Notice that the results are not ordered by account_id or standard_qty.
